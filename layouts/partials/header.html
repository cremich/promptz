<header
  class="sticky top-0 z-50 w-full border-b border-border/40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60"
>
  <div class="max-w-6xl mx-auto px-6">
    <div class="flex h-14 items-center justify-between">
      <!-- Logo -->
      <a href="/" class="flex items-center transition-opacity hover:opacity-80">
        {{ $logo := resources.Get "images/promptz_logo.png" }}
        {{ with $logo }}
          <img src="{{ .RelPermalink }}" alt="Promptz" class="h-8 w-auto" />
        {{ else }}
          <div
            class="h-8 w-8 rounded-lg bg-primary flex items-center justify-center shadow-lg"
          >
            <span class="text-primary-foreground font-bold text-lg">P</span>
          </div>
          <span class="font-bold text-xl text-foreground ml-2">Promptz</span>
        {{ end }}
      </a>

      <!-- Desktop Navigation and Search -->
      <div class="hidden md:flex items-center space-x-6">
        <nav class="flex items-center space-x-6">
          <a
            href="/prompts"
            class="text-sm font-medium text-muted-foreground hover:text-foreground transition-colors"
            >Prompts</a
          >
          <a
            href="/rules"
            class="text-sm font-medium text-muted-foreground hover:text-foreground transition-colors"
            >Rules</a
          >
          <a
            href="/agents"
            class="text-sm font-medium text-muted-foreground hover:text-foreground transition-colors"
            >Agents</a
          >
          <a
            href="/contribute"
            class="text-sm font-medium bg-gradient-to-r from-violet-500 via-purple-500 to-blue-500 bg-clip-text text-transparent hover:from-violet-600 hover:via-purple-600 hover:to-blue-600 transition-all"
            >Contribute</a
          >
        </nav>

        <!-- Desktop Search -->
        {{ if ne .RelPermalink "/search/" }}
          <button
            onclick="document.getElementById('search-modal').showModal(); document.body.style.overflow = 'hidden'; initModalSearch(); setTimeout(() => { const searchInput = document.querySelector('#modal-search .pagefind-ui__search-input'); if (searchInput) searchInput.focus(); }, 100);"
            class="flex items-center gap-2 w-36 px-3 py-2 text-sm bg-muted/50 border border-border rounded-lg hover:bg-muted/70 transition-all text-muted-foreground text-left"
          >
            <svg
              class="h-4 w-4"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
              ></path>
            </svg>
            <span class="flex-1">Search...</span>
            <kbd
              class="px-1.5 py-0.5 text-xs bg-background border border-border rounded"
              >⌘K</kbd
            >
          </button>
        {{ end }}
      </div>

      <!-- Mobile Menu Button -->
      <button
        class="md:hidden p-2 rounded-lg hover:bg-muted transition-colors"
        onclick="toggleMobileMenu()"
        aria-label="Toggle navigation menu"
      >
        <svg
          class="h-5 w-5 text-foreground"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16"
          ></path>
        </svg>
      </button>
    </div>

    <!-- Mobile Menu -->
    <div
      id="mobile-menu"
      class="md:hidden hidden border-t border-border/40 py-4 space-y-4"
    >
      <nav class="flex flex-col space-y-3">
        <a
          href="/prompts"
          class="text-sm font-medium text-muted-foreground hover:text-foreground transition-colors px-2 py-1"
          >Prompts</a
        >
        <a
          href="/rules"
          class="text-sm font-medium text-muted-foreground hover:text-foreground transition-colors px-2 py-1"
          >Rules</a
        >
        <a
          href="/agents"
          class="text-sm font-medium text-muted-foreground hover:text-foreground transition-colors px-2 py-1"
          >Agents</a
        >
        <a
          href="/contribute"
          class="text-sm font-medium text-primary hover:text-primary/80 transition-colors px-2 py-1"
          >Contribute</a
        >
      </nav>

      <!-- Mobile Search -->
      {{ if ne .RelPermalink "/search/" }}
        <button
          onclick="document.getElementById('search-modal').showModal(); document.body.style.overflow = 'hidden'; initModalSearch(); setTimeout(() => { const searchInput = document.querySelector('#modal-search .pagefind-ui__search-input'); if (searchInput) searchInput.focus(); }, 100);"
          class="flex items-center gap-2 w-full px-3 py-2 text-sm bg-muted/50 border border-border rounded-lg hover:bg-muted/70 transition-all text-muted-foreground text-left"
        >
          <svg
            class="h-4 w-4"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
            ></path>
          </svg>
          <span class="flex-1">Search prompts...</span>
          <kbd
            class="px-1.5 py-0.5 text-xs bg-background border border-border rounded"
            >⌘K</kbd
          >
        </button>
      {{ end }}
    </div>
  </div>

  <script>
    function toggleMobileMenu() {
      const menu = document.getElementById("mobile-menu");
      menu.classList.toggle("hidden");
    }
  </script>
</header>
